@namespace Blazwind.Components.Button
@using Blazwind.Components.Shared

@{
    var baseClasses = "relative inline-flex items-center justify-center gap-2 font-medium rounded transition-all focus:outline-none focus:ring-2 focus:ring-offset-1 dark:focus:ring-offset-gray-900 disabled:opacity-50 disabled:cursor-not-allowed border-2 border-transparent";
    
    // Size classes
    var sizeClasses = Size switch
    {
        BwSize.Small => "px-3 py-1.5 text-xs",
        BwSize.Large => "px-6 py-3 text-base",
        _ => "px-4 py-2 text-sm" // Medium
    };
    
    // Icon-only adjustments
    if (IconPosition == BwIconPosition.Only)
    {
        sizeClasses = Size switch
        {
            BwSize.Small => "p-1.5",
            BwSize.Large => "p-3",
            _ => "p-2"
        };
    }
    
    // Variant + Type classes
    var variantClasses = (Color, Variant) switch
    {
        // Primary - Filled with dark mode brightness
        (BwColor.Primary, BwVariant.Filled) => "bg-blue-600 dark:bg-blue-500 text-white hover:bg-blue-700 dark:hover:bg-blue-600 focus:ring-blue-500 active:bg-blue-800 dark:active:bg-blue-700",
        (BwColor.Primary, BwVariant.Outline) => "border-2 border-blue-600 dark:border-blue-400 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/30 focus:ring-blue-500",
        (BwColor.Primary, BwVariant.Ghost) => "text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/30 focus:ring-blue-500",
        (BwColor.Primary, BwVariant.Soft) => "bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 hover:bg-blue-200 dark:hover:bg-blue-900/50 focus:ring-blue-500",
        (BwColor.Primary, BwVariant.Link) => "text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 !p-0 !h-auto outline-none border-none focus:outline-none focus:ring-0",
        
        // Secondary - Filled with dark mode brightness
        (BwColor.Secondary, BwVariant.Filled) => "bg-gray-600 dark:bg-gray-500 text-white hover:bg-gray-700 dark:hover:bg-gray-600 focus:ring-gray-500 active:bg-gray-800 dark:active:bg-gray-700",
        (BwColor.Secondary, BwVariant.Outline) => "border-2 border-gray-400 dark:border-gray-500 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800 focus:ring-gray-400",
        (BwColor.Secondary, BwVariant.Ghost) => "text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 focus:ring-gray-400",
        (BwColor.Secondary, BwVariant.Soft) => "bg-gray-100 dark:bg-gray-800 text-gray-800 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700 focus:ring-gray-500",
        (BwColor.Secondary, BwVariant.Link) => "text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 !p-0 !h-auto outline-none border-none focus:outline-none focus:ring-0",
        
        // Success - Filled with dark mode brightness
        (BwColor.Success, BwVariant.Filled) => "bg-emerald-600 dark:bg-emerald-500 text-white hover:bg-emerald-700 dark:hover:bg-emerald-600 focus:ring-emerald-500 active:bg-emerald-800 dark:active:bg-emerald-700",
        (BwColor.Success, BwVariant.Outline) => "border-2 border-emerald-600 dark:border-emerald-500 text-emerald-600 dark:text-emerald-500 hover:bg-emerald-50 dark:hover:bg-emerald-900/30 focus:ring-emerald-500",
        (BwColor.Success, BwVariant.Ghost) => "text-emerald-600 dark:text-emerald-500 hover:bg-emerald-50 dark:hover:bg-emerald-900/30 focus:ring-emerald-500",
        (BwColor.Success, BwVariant.Soft) => "bg-emerald-100 dark:bg-emerald-900/30 text-emerald-800 dark:text-emerald-300 hover:bg-emerald-200 dark:hover:bg-emerald-900/50 focus:ring-emerald-500",
        (BwColor.Success, BwVariant.Link) => "text-emerald-600 dark:text-emerald-500 hover:text-emerald-700 dark:hover:text-emerald-400 !p-0 !h-auto outline-none border-none focus:outline-none focus:ring-0",
        
        // Danger - Filled with dark mode brightness
        (BwColor.Danger, BwVariant.Filled) => "bg-red-600 dark:bg-red-500 text-white hover:bg-red-700 dark:hover:bg-red-600 focus:ring-red-500 active:bg-red-800 dark:active:bg-red-700",
        (BwColor.Danger, BwVariant.Outline) => "border-2 border-red-600 dark:border-red-500 text-red-600 dark:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/30 focus:ring-red-500",
        (BwColor.Danger, BwVariant.Ghost) => "text-red-600 dark:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/30 focus:ring-red-500",
        (BwColor.Danger, BwVariant.Soft) => "bg-red-100 dark:bg-red-900/30 text-red-800 dark:text-red-300 hover:bg-red-200 dark:hover:bg-red-900/50 focus:ring-red-500",
        (BwColor.Danger, BwVariant.Link) => "text-red-600 dark:text-red-500 hover:text-red-700 dark:hover:text-red-400 !p-0 !h-auto outline-none border-none focus:outline-none focus:ring-0",
        
        // Warning - Filled with dark mode brightness
        (BwColor.Warning, BwVariant.Filled) => "bg-amber-500 dark:bg-amber-400 text-white dark:text-gray-900 hover:bg-amber-600 dark:hover:bg-amber-500 focus:ring-amber-400 active:bg-amber-700 dark:active:bg-amber-600",
        (BwColor.Warning, BwVariant.Outline) => "border-2 border-amber-500 dark:border-amber-400 text-amber-600 dark:text-amber-400 hover:bg-amber-50 dark:hover:bg-amber-900/30 focus:ring-amber-400",
        (BwColor.Warning, BwVariant.Ghost) => "text-amber-600 dark:text-amber-400 hover:bg-amber-50 dark:hover:bg-amber-900/30 focus:ring-amber-400",
        (BwColor.Warning, BwVariant.Soft) => "bg-amber-100 dark:bg-amber-900/30 text-amber-800 dark:text-amber-300 hover:bg-amber-200 dark:hover:bg-amber-900/50 focus:ring-amber-400",
        (BwColor.Warning, BwVariant.Link) => "text-amber-600 dark:text-amber-400 hover:text-amber-700 dark:hover:text-amber-300 !p-0 !h-auto outline-none border-none focus:outline-none focus:ring-0",
        
        // Info - Filled with dark mode brightness
        (BwColor.Info, BwVariant.Filled) => "bg-sky-500 dark:bg-sky-400 text-white dark:text-gray-900 hover:bg-sky-600 dark:hover:bg-sky-500 focus:ring-sky-400 active:bg-sky-700 dark:active:bg-sky-600",
        (BwColor.Info, BwVariant.Outline) => "border-2 border-sky-500 dark:border-sky-400 text-sky-600 dark:text-sky-400 hover:bg-sky-50 dark:hover:bg-sky-900/30 focus:ring-sky-400",
        (BwColor.Info, BwVariant.Ghost) => "text-sky-600 dark:text-sky-400 hover:bg-sky-50 dark:hover:bg-sky-900/30 focus:ring-sky-400",
        (BwColor.Info, BwVariant.Soft) => "bg-sky-100 dark:bg-sky-900/30 text-sky-800 dark:text-sky-300 hover:bg-sky-200 dark:hover:bg-sky-900/50 focus:ring-sky-400",
        (BwColor.Info, BwVariant.Link) => "text-sky-600 dark:text-sky-400 hover:text-sky-700 dark:hover:text-sky-300 !p-0 !h-auto outline-none border-none focus:outline-none focus:ring-0",
        
        // Light
        (BwColor.Light, _) => "bg-white dark:bg-gray-800 text-gray-800 dark:text-gray-200 border border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700 focus:ring-gray-200 dark:focus:ring-gray-600",
        
        // Dark
        (BwColor.Dark, _) => "bg-gray-900 dark:bg-gray-700 text-white hover:bg-gray-800 dark:hover:bg-gray-600 focus:ring-gray-800 dark:focus:ring-gray-600",

        _ => "bg-blue-600 dark:bg-blue-500 text-white hover:bg-blue-700 dark:hover:bg-blue-600 focus:ring-blue-500"
    };
    
    // Icon size
    var iconSize = Size switch
    {
        BwSize.Small => "text-xs",
        BwSize.Large => "text-lg",
        _ => "text-sm"
    };
    
    var allClasses = $"{baseClasses} {sizeClasses} {variantClasses} {Class}";
}

<button type="@HtmlType" 
        class="@allClasses" 
        disabled="@Disabled"
        @onclick="OnClick"
        @attributes="AdditionalAttributes">
    @if (!string.IsNullOrEmpty(Icon) && IconPosition == BwIconPosition.Left)
    {
        <i class="@Icon @iconSize"></i>
    }
    
    @if (IconPosition != BwIconPosition.Only)
    {
        @if (ChildContent != null)
        {
            @ChildContent
        }
        else if (!string.IsNullOrEmpty(Text))
        {
            <span>@Text</span>
        }
    }
    
    @if (!string.IsNullOrEmpty(Icon) && IconPosition == BwIconPosition.Right)
    {
        <i class="@Icon @iconSize"></i>
    }
    
    @if (!string.IsNullOrEmpty(Icon) && IconPosition == BwIconPosition.Only)
    {
        <i class="@Icon @iconSize"></i>
    }
    
    @if (IsLoading)
    {
        <i class="fa-solid fa-spinner animate-spin @iconSize"></i>
    }

    @if (BadgeContent != null)
    {
        <div class="absolute top-0 right-0 translate-x-1/4 -translate-y-1/4">
            @BadgeContent
        </div>
    }
</button>

@code {
    [Parameter] public string? Text { get; set; }
    [Parameter] public RenderFragment? ChildContent { get; set; }
    [Parameter] public RenderFragment? BadgeContent { get; set; }
    [Parameter] public string? Icon { get; set; }
    [Parameter] public BwIconPosition IconPosition { get; set; } = BwIconPosition.Left;
    [Parameter] public BwColor Color { get; set; } = BwColor.Primary;
    [Parameter] public BwVariant Variant { get; set; } = BwVariant.Filled;
    [Parameter] public BwSize Size { get; set; } = BwSize.Medium;
    [Parameter] public bool Disabled { get; set; }
    [Parameter] public bool IsLoading { get; set; }
    [Parameter] public string HtmlType { get; set; } = "button";
    [Parameter] public string? Class { get; set; }
    [Parameter] public EventCallback<MouseEventArgs> OnClick { get; set; }
    [Parameter(CaptureUnmatchedValues = true)] public Dictionary<string, object>? AdditionalAttributes { get; set; }
}
