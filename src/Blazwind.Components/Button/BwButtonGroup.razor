@namespace Blazwind.Components.Button
@using Blazwind.Components.Shared
@inherits BwBase

<div class="@AllClasses" role="group" style="@Style" @attributes="AdditionalAttributes">
    @ChildContent
</div>

@code {
    [Parameter] public RenderFragment? ChildContent { get; set; }
    [Parameter] public BwOrientation Orientation { get; set; } = BwOrientation.Horizontal;
    [Parameter] public bool IsFullWidth { get; set; }
    [Parameter] public bool IsAttached { get; set; } = true;
    [Parameter] public BwSize Size { get; set; } = BwSize.Medium;
    [Parameter] public BwColor Color { get; set; } = BwColor.Primary;
    [Parameter] public BwVariant Variant { get; set; } = BwVariant.Filled;

    private string AllClasses => $"{ContainerClasses} {GroupClasses} {Class}".Trim();

    private string ContainerClasses => Orientation == BwOrientation.Vertical
        ? $"inline-flex flex-col {WidthClass} {ShadowClass}"
        : $"inline-flex flex-row {WidthClass} {ShadowClass}";
    
    private string WidthClass => IsFullWidth ? "w-full" : "w-fit";
    
    private string ShadowClass => IsAttached ? "shadow-sm rounded-md" : "";

    private string GroupClasses => IsAttached 
        ? (Orientation == BwOrientation.Vertical ? VerticalAttachedClasses : HorizontalAttachedClasses)
        : (Orientation == BwOrientation.Vertical ? VerticalGapClasses : HorizontalGapClasses);
    
    // Attached mode - buttons touch each other
    private string HorizontalAttachedClasses => 
        "[&>*:not(:first-child)]:rounded-l-none [&>*:not(:last-child)]:rounded-r-none [&>*:not(:first-child)]:-ml-px [&>*]:shadow-none [&>*]:focus:ring-0";
    
    private string VerticalAttachedClasses => 
        "[&>*:not(:first-child)]:rounded-t-none [&>*:not(:last-child)]:rounded-b-none [&>*:not(:first-child)]:-mt-px [&>*]:shadow-none [&>*]:focus:ring-0";
    
    // Gap mode - buttons have spacing between them
    private string HorizontalGapClasses => "gap-1";
    private string VerticalGapClasses => "gap-1";
}
