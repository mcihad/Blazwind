@namespace Blazwind.Components.Toolbar
@using Blazwind.Components.Shared
@inherits BwBase

<CascadingValue Value="this">
    <div class="@AllClasses" style="@AllStyles" @attributes="AdditionalAttributes">
        @ChildContent
    </div>
</CascadingValue>

@code {

    [Parameter]
    public RenderFragment? ChildContent { get; set; }

    [Parameter]
    public ToolbarOrientation Orientation { get; set; } = ToolbarOrientation.Horizontal;

    [Parameter]
    public ToolbarPosition Position { get; set; } = ToolbarPosition.None;

    [Parameter]
    public BwSize Size { get; set; } = BwSize.Medium;

    [Parameter]
    public BwColor Color { get; set; } = BwColor.Secondary;

    [Parameter]
    public bool Rounded { get; set; } = true;

    [Parameter]
    public bool Shadow { get; set; } = true;

    [Parameter]
    public bool Glass { get; set; } = true;

    [Parameter]
    public int Offset { get; set; } = 16;

    /// <summary>Allow items to wrap on multiple lines</summary>
    [Parameter]
    public bool Wrap { get; set; }

    /// <summary>Max width constraint (e.g. "100%", "400px")</summary>
    [Parameter]
    public string? MaxWidth { get; set; }

    public bool IsAtBottom => Position is ToolbarPosition.Bottom or ToolbarPosition.BottomLeft or
        ToolbarPosition.BottomRight;

    public bool IsAtTop => Position is ToolbarPosition.Top or ToolbarPosition.TopLeft or ToolbarPosition.TopRight;
    public bool IsAtRight => Position is ToolbarPosition.Right or ToolbarPosition.TopRight or ToolbarPosition.BottomRight;
    public bool IsVertical => Orientation == ToolbarOrientation.Vertical;

    private string AllClasses
    {
        get
        {
            var classes = new List<string>
            {
                "bw-toolbar",
                OrientationClass,
                SizeClass,
                Wrap ? "flex-wrap" : "",
                Rounded ? "rounded" : "",
                Shadow ? "shadow" : "",
                Glass ? "glass" : ""
            };

            if (Position != ToolbarPosition.None)
            {
                classes.Add("fixed");
                classes.Add(PositionClass);
            }

            if (!string.IsNullOrEmpty(Class))
                classes.Add(Class);

            return string.Join(" ", classes.Where(c => !string.IsNullOrEmpty(c)));
        }
    }

    private string AllStyles
    {
        get
        {
            var styles = new List<string>();
            if (!string.IsNullOrEmpty(MaxWidth))
                styles.Add($"max-width: {MaxWidth}");
            if (!string.IsNullOrEmpty(Style))
                styles.Add(Style);
            return string.Join(";", styles);
        }
    }

    private string OrientationClass => Orientation == ToolbarOrientation.Vertical ? "vertical" : "horizontal";

    private string SizeClass => Size.ToString().ToLower();

    private string PositionClass => Position switch
    {
        ToolbarPosition.Top => "top-4 left-1/2 -translate-x-1/2",
        ToolbarPosition.Bottom => "bottom-4 left-1/2 -translate-x-1/2",
        ToolbarPosition.Left => "left-4 top-1/2 -translate-y-1/2",
        ToolbarPosition.Right => "right-4 top-1/2 -translate-y-1/2",
        ToolbarPosition.TopLeft => "top-4 left-4",
        ToolbarPosition.TopRight => "top-4 right-4",
        ToolbarPosition.BottomLeft => "bottom-4 left-4",
        ToolbarPosition.BottomRight => "bottom-4 right-4",
        _ => ""
    };

}