@namespace Blazwind.Components.Toolbar
@using Blazwind.Components.Shared
@inherits BwBase

<button type="button" class="@CombineClasses(AllClasses)" style="@Style" id="@Id" @attributes="AdditionalAttributes" disabled="@Disabled" title="@Tooltip" @onclick="HandleClick">
    @if (!string.IsNullOrEmpty(Icon))
    {
        <i class="@Icon @IconSizeClass"></i>
    }
    @if (!string.IsNullOrEmpty(Text))
    {
        <span class="@TextClass font-medium">@Text</span>
    }
</button>

@code {
    [CascadingParameter] public BwToolbar? Toolbar { get; set; }

    [Parameter] public string? Icon { get; set; }
    [Parameter] public string? Text { get; set; }
    [Parameter] public string? Tooltip { get; set; }
    [Parameter] public bool Disabled { get; set; }
    [Parameter] public bool IsActive { get; set; }
    [Parameter] public BwColor Color { get; set; } = BwColor.Secondary;
    [Parameter] public EventCallback OnClick { get; set; }

    private string AllClasses
    {
        get
        {
            var size = Toolbar?.Size ?? BwSize.Medium;
            var classes = new List<string>
            {
                "bw-tool-btn",
                SizeClasses(size),
                IsActive ? "active" : "",
                IsActive ? ActiveClasses : ""
            };
            return string.Join(" ", classes);
        }
    }

    private string SizeClasses(BwSize size) => size.ToString().ToLower();

    private string IconSizeClass => (Toolbar?.Size ?? BwSize.Medium) switch
    {
        BwSize.Small => "text-xs",
        BwSize.Large => "text-lg",
        _ => "text-sm"
    };

    private string TextClass => (Toolbar?.Size ?? BwSize.Medium) switch
    {
        BwSize.Small => "text-xs",
        BwSize.Large => "text-sm",
        _ => "text-xs"
    };

    private string ActiveClasses => $"variant-{Color.ToString().ToLower()}";

    private async Task HandleClick()
    {
        if (!Disabled)
        {
            await OnClick.InvokeAsync();
        }
    }
}