@using Blazwind.Components.Button
@using Blazwind.Components.Shared
@namespace Blazwind.Components.Dialog

<div class="flex flex-col h-full rounded overflow-hidden border @ContainerClass shadow-sm">
    <div class="p-5 flex flex-col gap-4">
        <div class="flex items-start gap-4">
            <div class="mt-0.5 text-3xl shrink-0">
                @((MarkupString)GetIconHtml())
            </div>
            <div class="flex-1 min-w-0">
                <h3 class="@TitleSizeClass font-bold bw-dialog-text-primary mb-2 leading-tight">@Title</h3>
                <p class="text-sm bw-dialog-text-secondary leading-relaxed text-pretty">@Message</p>
            </div>
        </div>

        <div class="flex justify-end gap-3 mt-2">
            @if (!string.IsNullOrEmpty(CancelText))
            {
                <BwButton Text="@CancelText" Color="BwColor.Secondary" Variant="BwVariant.Ghost" Size="BwSize.Medium"
                          OnClick="Cancel" Class="!px-4 !py-2"/>
            }
            <BwButton Text="@ConfirmText" Color="@Color" Variant="BwVariant.Filled" Size="BwSize.Medium"
                      OnClick="Confirm" Class="!px-4 !py-2 shadow-sm"/>
        </div>
    </div>
</div>

@code {

    [CascadingParameter]
    DialogInstance DialogInstance { get; set; } = default!;

    [Inject]
    DialogService DialogService { get; set; } = default!;

    [Parameter]
    public string Title { get; set; } = "Bildirim";

    [Parameter]
    public string Message { get; set; } = "";

    [Parameter]
    public BwColor Color { get; set; } = BwColor.Info;

    [Parameter]
    public string ConfirmText { get; set; } = "Tamam";

    [Parameter]
    public string? CancelText { get; set; }

    private string ContainerClass => Color switch
    {
        BwColor.Success => "bw-dialog-inner-success",
        BwColor.Warning => "bw-dialog-inner-warning",
        BwColor.Danger => "bw-dialog-inner-danger",
        BwColor.Info => "bw-dialog-inner-info",
        _ => "bw-dialog-inner-default"
    };

    private string GetIconHtml()
    {
        return Color switch
        {
            BwColor.Success => "<i class=\"fa-solid fa-circle-check bw-icon-success\"></i>",
            BwColor.Warning => "<i class=\"fa-solid fa-triangle-exclamation bw-icon-warning\"></i>",
            BwColor.Danger => "<i class=\"fa-solid fa-circle-xmark bw-icon-danger\"></i>",
            _ => "<i class=\"fa-solid fa-circle-info bw-icon-info\"></i>"
        };
    }

    private string TitleSizeClass => (DialogInstance.Options.TitleSize ?? BwSize.Medium) switch
    {
        BwSize.ExtraSmall => "text-sm",
        BwSize.Small => "text-base",
        BwSize.Medium => "text-lg",
        BwSize.Large => "text-xl",
        BwSize.ExtraLarge => "text-2xl",
        _ => "text-lg"
    };

    private void Confirm()
    {
        DialogService.Close(DialogInstance, DialogResult.Ok((object)true));
    }

    private void Cancel()
    {
        DialogService.Close(DialogInstance, DialogResult.Cancel());
    }

}
