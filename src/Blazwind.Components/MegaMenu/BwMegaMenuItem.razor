@namespace Blazwind.Components.MegaMenu
@using Blazwind.Components.Shared
@using Microsoft.AspNetCore.Components.Routing
@inherits BwBase

@if (!string.IsNullOrEmpty(Href))
{
    <NavLink href="@Href" class="@AllClasses" style="@Style" id="@Id" @attributes="AdditionalAttributes"
             Match="NavLinkMatch.All">
        @RenderContent
    </NavLink>
}
else
{
    <div class="@AllClasses" style="@Style" id="@Id" @attributes="AdditionalAttributes" @onclick="HandleClick">
        @RenderContent
    </div>
}

@code {

    [Parameter]
    public string? Label { get; set; }

    [Parameter]
    public string? Description { get; set; }

    [Parameter]
    public string? Icon { get; set; }

    [Parameter]
    public string? Href { get; set; }

    [Parameter]
    public string? Badge { get; set; }

    [Parameter]
    public BwColor BadgeColor { get; set; } = BwColor.Primary;

    [Parameter]
    public bool IsNew { get; set; }

    [Parameter]
    public bool Disabled { get; set; }

    [Parameter]
    public EventCallback OnClick { get; set; }

    private string AllClasses => CombineClasses("bw-megamenu-item", Disabled ? "bw-megamenu-item--disabled" : null);

    private RenderFragment RenderContent => __builder =>
    {
        @if (!string.IsNullOrEmpty(Icon))
        {
            <i class="@Icon bw-megamenu-item-icon"></i>
        }

        <span class="bw-megamenu-item-label">@Label</span>
        @if (IsNew)
        {
            <span class="bw-megamenu-badge bw-megamenu-badge--new">
                Yeni
            </span>
        }

        @if (!string.IsNullOrEmpty(Badge))
        {
            <span class="bw-megamenu-badge @BadgeClasses">@Badge</span>
        }
    };

    private string BadgeClasses => BadgeColor switch
    {
        BwColor.Primary => "bw-megamenu-badge--primary",
        BwColor.Success => "bw-megamenu-badge--success",
        BwColor.Warning => "bw-megamenu-badge--warning",
        BwColor.Danger => "bw-megamenu-badge--danger",
        BwColor.Info => "bw-megamenu-badge--info",
        _ => "bw-megamenu-badge--default"
    };

    private async Task HandleClick()
    {
        if (!Disabled)
        {
            await OnClick.InvokeAsync();
        }
    }

}