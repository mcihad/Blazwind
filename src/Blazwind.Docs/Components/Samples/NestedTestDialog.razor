@using Blazwind.Components.Dialog
@using Blazwind.Components.Button
@using Blazwind.Components.Layout
@using Blazwind.Components.Typography
@using Blazwind.Components.Card
@using Blazwind.Components.Shared
@inject DialogService DialogService

<BwColumn Spacing="BwSpacing.Md">
    <BwTypography Tag="BwTypographyTag.P">
        This dialog layer: <BwTypography Tag="BwTypographyTag.Strong" Weight="BwFontWeight.Bold">@Depth</BwTypography>
    </BwTypography>

    <BwCard Color="BwColor.Secondary">
        <BwColumn Spacing="BwSpacing.Sm">
            <BwTypography Tag="BwTypographyTag.P" Size="BwSize.Small">Press the button below for nested dialog test:
            </BwTypography>
            <BwButton Text="Open New Dialog (Nested)" Color="BwColor.Warning" OnClick="OpenNext" />
        </BwColumn>
    </BwCard>

    <BwRow MainAxisAlignment="BwMainAxisAlignment.End" Class="pt-4 border-t border-gray-100 dark:border-gray-700">
        <BwButton Text="Close" Color="BwColor.Secondary" Variant="BwVariant.Ghost" OnClick="Close" />
    </BwRow>
</BwColumn>

@code {
    [Parameter] public int Depth { get; set; } = 1;
    [CascadingParameter] public DialogInstance? DialogInstance { get; set; }

    private async Task OpenNext()
    {
        var options = new DialogOptions
        {
            Width = "400px",
            Draggable = true
        };

        // We need to pass title to ShowAsync separately
        await DialogService.ShowAsync<NestedTestDialog>($"Nested Dialog - Layer {Depth + 1}", new Dictionary<string, object> { {
"Depth", Depth + 1 } }, options);
    }

    private void Close()
    {
        if (DialogInstance != null) DialogService.Close(DialogInstance);
    }
}